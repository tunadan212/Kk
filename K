
local CoreGui=game:GetService("CoreGui")
local UIS=game:GetService("UserInputService")
local VIM=game:GetService("VirtualInputManager")
local TweenService=game:GetService("TweenService")

local GUI_NAME="Khngscript_AllInOne"
local old=CoreGui:FindFirstChild(GUI_NAME); if old then old:Destroy() end

local function toast(parent,title,msg,dur)
    dur=dur or 3
    local t=Instance.new("TextLabel")
    t.BackgroundColor3=Color3.fromRGB(35,160,95)
    t.TextColor3=Color3.fromRGB(255,255,255)
    t.Font=Enum.Font.Gotham
    t.TextSize=16
    t.Text=title.." - "..msg
    t.AutomaticSize=Enum.AutomaticSize.XY
    t.ZIndex=9999
    t.AnchorPoint=Vector2.new(0.5,1)
    t.Position=UDim2.new(0.5,0,0,-10)
    t.Parent=parent
    Instance.new("UICorner",t).CornerRadius=UDim.new(0,8)
    task.delay(dur,function() if t and t.Parent then t:Destroy() end end)
end
local function pill(parent,text)
    local b=Instance.new("TextButton")
    b.Size=UDim2.new(0.48,0,0,46)
    b.BackgroundColor3=Color3.fromRGB(114,106,240)
    b.Text=text
    b.TextColor3=Color3.fromRGB(255,255,255)
    b.Font=Enum.Font.GothamSemibold
    b.TextSize=18
    b.AutoButtonColor=true
    b.Active=true; b.Selectable=true
    b.Parent=parent
    Instance.new("UICorner",b).CornerRadius=UDim.new(0,12)
    local s=Instance.new("UIStroke",b) s.Thickness=1.2 s.Color=Color3.fromRGB(255,255,255) s.Transparency=0.75
    return b
end
local function pillColor(btn,r,g,b) btn.BackgroundColor3=Color3.fromRGB(r,g,b) end
local function dragify(handle,target)
    local dragging=false; local dragInput; local startPos; local startInputPos
    handle.InputBegan:Connect(function(input)
        if input.UserInputType==Enum.UserInputType.MouseButton1 or input.UserInputType==Enum.UserInputType.Touch then
            dragging=true; startPos=target.Position; startInputPos=input.Position
            input.Changed:Connect(function() if input.UserInputState==Enum.UserInputState.End then dragging=false end end)
        end
    end)
    handle.InputChanged:Connect(function(input)
        if input.UserInputType==Enum.UserInputType.MouseMovement or input.UserInputType==Enum.UserInputType.Touch then dragInput=input end
    end)
    UIS.InputChanged:Connect(function(input)
        if dragging and input==dragInput then
            local d=input.Position-startInputPos
            target.Position=UDim2.new(startPos.X.Scale,startPos.X.Offset+d.X,startPos.Y.Scale,startPos.Y.Offset+d.Y)
        end
    end)
end

local gui=Instance.new("ScreenGui")
gui.Name=GUI_NAME
gui.IgnoreGuiInset=true
gui.ZIndexBehavior=Enum.ZIndexBehavior.Global
gui.Parent=CoreGui

local bg=Instance.new("Frame",gui)
bg.Size=UDim2.new(1,0,1,0)
bg.BackgroundColor3=Color3.fromRGB(0,0,0)
bg.BackgroundTransparency=0.35

local box=Instance.new("Frame",gui)
box.AnchorPoint=Vector2.new(0.5,0.5)
box.Position=UDim2.new(0.5,0,0.5,0)
box.Size=UDim2.new(0,420,0,140)
box.BackgroundColor3=Color3.fromRGB(15,15,15)
box.BorderSizePixel=0
Instance.new("UICorner",box).CornerRadius=UDim.new(0,16)

local avatar=Instance.new("ImageLabel",box)
avatar.Size=UDim2.new(0,56,0,56)
avatar.Position=UDim2.new(0,16,0,12)
avatar.BackgroundTransparency=1
avatar.Image="rbxassetid://115555110268657"
Instance.new("UICorner",avatar).CornerRadius=UDim.new(1,0)

local title=Instance.new("TextLabel",box)
title.BackgroundTransparency=1
title.Position=UDim2.new(0,84,0,16)
title.Size=UDim2.new(1,-90,0,28)
title.Font=Enum.Font.GothamBold
title.TextSize=22
title.TextColor3=Color3.fromRGB(255,255,255)
title.TextXAlignment=Enum.TextXAlignment.Left
title.Text="TikTok/Youtube: Khngscript"

local barBg=Instance.new("Frame",box)
barBg.AnchorPoint=Vector2.new(0.5,0)
barBg.Position=UDim2.new(0.5,0,0,78)
barBg.Size=UDim2.new(0.9,0,0,24)
barBg.BackgroundColor3=Color3.fromRGB(45,45,45)
barBg.BorderSizePixel=0
Instance.new("UICorner",barBg).CornerRadius=UDim.new(0,12)

local fill=Instance.new("Frame",barBg)
fill.Size=UDim2.new(0,0,1,0)
fill.BackgroundColor3=Color3.fromRGB(160,90,255)
fill.BorderSizePixel=0
Instance.new("UICorner",fill).CornerRadius=UDim.new(0,12)

local sub=Instance.new("TextLabel",box)
sub.AnchorPoint=Vector2.new(0.5,1)
sub.Position=UDim2.new(0.5,0,1,-6)
sub.Size=UDim2.new(1,-20,0,24)
sub.BackgroundTransparency=1
sub.Font=Enum.Font.GothamBold
sub.TextSize=18
sub.TextColor3=Color3.fromRGB(255,255,255)
sub.Text="Subscribe to Khngscript"

TweenService:Create(fill,TweenInfo.new(5,Enum.EasingStyle.Linear),{Size=UDim2.new(1,0,1,0)}):Play()

-- ==== main hub (·∫©n cho t·ªõi khi xong loading) ====
local frame=Instance.new("Frame",gui)
frame.Visible=false
frame.Size=UDim2.new(0,440,0,240)
frame.Position=UDim2.new(0.5,-220,0.5,-120)
frame.BackgroundColor3=Color3.fromRGB(20,22,26)
frame.BorderSizePixel=0
frame.Active=true
Instance.new("UICorner",frame).CornerRadius=UDim.new(0,16)
local fs=Instance.new("UIStroke",frame) fs.Color=Color3.fromRGB(85,85,95) fs.Thickness=1

local titleBar=Instance.new("Frame",frame)
titleBar.Size=UDim2.new(1,0,0,48)
titleBar.BackgroundColor3=Color3.fromRGB(28,30,36)
titleBar.BorderSizePixel=0
titleBar.Active=true
Instance.new("UICorner",titleBar).CornerRadius=UDim.new(0,16)
local t=Instance.new("TextLabel",titleBar)
t.BackgroundTransparency=1
t.Size=UDim2.new(1,-120,1,0)
t.Position=UDim2.new(0,16,0,0)
t.Font=Enum.Font.GothamBlack
t.TextSize=20
t.TextXAlignment=Enum.TextXAlignment.Left
t.TextColor3=Color3.fromRGB(235,235,245)
t.Text="Khngscript Hub"
dragify(titleBar,frame)

local body=Instance.new("Frame",frame)
body.BackgroundTransparency=1
body.Size=UDim2.new(1,-24,1,-64)
body.Position=UDim2.new(0,12,0,56)
local layout=Instance.new("UIGridLayout",body)
layout.CellPadding=UDim2.new(0,12,0,12)
layout.CellSize=UDim2.new(0.5,-6,0,46)
layout.FillDirectionMaxCells=2
layout.HorizontalAlignment=Enum.HorizontalAlignment.Center
layout.VerticalAlignment=Enum.VerticalAlignment.Top

local btnClone=pill(body,"üß† Nh√¢n b·∫£n"); pillColor(btnClone,114,106,240)
btnClone.MouseButton1Click:Connect(function()
    VIM:SendKeyEvent(true,Enum.KeyCode.P,false,game); VIM:SendKeyEvent(false,Enum.KeyCode.P,false,game)
    toast(frame,"Nh√¢n b·∫£n","ƒê√£ g·ª≠i ph√≠m P",2)
end)

local btnClone2=pill(body,"üß† Nh√¢n b·∫£n v2"); pillColor(btnClone2,114,106,240)
btnClone2.MouseButton1Click:Connect(function()
    btnClone2.Text="ƒêang nh√¢n b·∫£n..."; pillColor(btnClone2,70,200,90)
    task.defer(function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/tunadan212/Kkkk/refs/heads/main/K"))()
    end)
end)

local btnExec=pill(body,"üéâ Execute Event"); pillColor(btnExec,114,106,240)
btnExec.MouseButton1Click:Connect(function()
    VIM:SendKeyEvent(true,Enum.KeyCode.Q,false,game); VIM:SendKeyEvent(false,Enum.KeyCode.Q,false,game)
    toast(frame,"Execute Event","ƒê√£ g·ª≠i ph√≠m Q",2)
end)

local btnSpawn=pill(body,"ü§§ Spawn Brainrot"); pillColor(btnSpawn,70,180,110)
local tb=Instance.new("TextBox",body)
tb.Size=UDim2.new(0.5,-6,0,46)
tb.BackgroundColor3=Color3.fromRGB(35,36,40)
tb.Text="nh·∫≠p t√™n brainrot"
tb.TextColor3=Color3.fromRGB(220,220,230)
tb.Font=Enum.Font.Gotham
tb.TextSize=16
tb.ClearTextOnFocus=false
Instance.new("UICorner",tb).CornerRadius=UDim.new(0,12)
local tbs=Instance.new("UIStroke",tb) tbs.Color=Color3.fromRGB(84,130,255) tbs.Thickness=1
btnSpawn.MouseButton1Click:Connect(function()
    VIM:SendKeyEvent(true,Enum.KeyCode.R,false,game); VIM:SendKeyEvent(false,Enum.KeyCode.R,false,game)
    toast(frame,"Spawn Brainrot","ƒê√£ g·ª≠i ph√≠m R ("..(tb.Text or "")..")",2)
end)

-- panel tr√≤n k√©o th·∫£ + ·∫©n/hi·ªán hub
local panel=Instance.new("ImageButton",gui)
panel.Visible=false
panel.Size=UDim2.new(0,64,0,64)
panel.AnchorPoint=Vector2.new(1,1)
panel.Position=UDim2.new(1,-16,1,-16)
panel.BackgroundColor3=Color3.fromRGB(28,30,36)
panel.Image="rbxassetid://115555110268657"
Instance.new("UICorner",panel).CornerRadius=UDim.new(1,0)
local ps=Instance.new("UIStroke",panel) ps.Color=Color3.fromRGB(84,130,255) ps.Thickness=1.2
dragify(panel,panel)
local visible=true
panel.MouseButton1Click:Connect(function() visible=not visible; frame.Visible=visible end)

-- h·∫øt 5s: show hub + panel, t·∫Øt loading
task.delay(5,function()
    if bg then bg:Destroy() end
    if box then box:Destroy() end
    frame.Visible=true
    panel.Visible=true
end)
